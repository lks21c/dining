generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model Restaurant {
  id               String  @id @default(cuid())
  name             String
  category         String
  description      String
  lat              Float
  lng              Float
  priceRange       String
  atmosphere       String
  goodFor          String
  rating           Float
  reviewCount      Int
  parkingAvailable Boolean @default(false)
  nearbyParking    String?

  @@index([lat, lng])
}

model Cafe {
  id               String  @id @default(cuid())
  name             String
  specialty        String
  description      String
  lat              Float
  lng              Float
  priceRange       String
  atmosphere       String
  goodFor          String
  rating           Float
  reviewCount      Int
  parkingAvailable Boolean @default(false)
  nearbyParking    String?

  @@index([lat, lng])
}

model ParkingLot {
  id             String  @id @default(cuid())
  name           String
  type           String
  address        String?
  lat            Float
  lng            Float
  capacity       Int
  hourlyRate     Int
  baseTime       Int?    // 기본 시간 (분) e.g. 30
  baseRate       Int?    // 기본 요금 (원) e.g. 1000
  extraTime      Int?    // 추가 단위 시간 (분) e.g. 5
  extraRate      Int?    // 추가 단위 요금 (원) e.g. 250
  freeNote       String? // 무료 주차 조건 메모
  description    String
  operatingHours String

  @@index([lat, lng])
}

model CrawledPlace {
  id          String        @id @default(cuid())
  name        String
  category    String?
  description String?
  address     String?
  lat         Float?
  lng         Float?
  phone       String?
  priceRange  String?
  atmosphere  String?
  goodFor     String?
  imageUrl    String?
  tags        String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  sources     PlaceSource[]

  @@index([lat, lng])
  @@index([name])
}

model PlaceSource {
  id             String       @id @default(cuid())
  crawledPlaceId String
  crawledPlace   CrawledPlace @relation(fields: [crawledPlaceId], references: [id], onDelete: Cascade)
  source         String
  sourceUrl      String?
  rating         Float?
  reviewCount    Int?
  snippet        String?
  metadata       String?
  crawledAt      DateTime     @default(now())

  @@unique([crawledPlaceId, source])
  @@index([source])
}

model Menu {
  id        String   @id @default(cuid())
  placeName String
  menuName  String
  price     String?
  source    String   @default("diningcode")
  crawledAt DateTime @default(now())

  @@unique([placeName, menuName, source])
  @@index([placeName])
}
